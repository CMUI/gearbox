<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gearbox Unit Test Sandbox</title>
</head>
<body>

<script src="../bower_components/underscore/underscore.js"></script>
<script src="../bower_components/jquery/dist/jquery.js"></script>
<script src="../dist/gearbox.js"></script>
<script>
(function () {
	'use strict'

	var testId

	if (/testId/.test(location.href)) {
		testId = location.href.split('?testId=')[1].split("&&")[0] || ''
	}

	if (testId) {

		var result = {}
		var undefinedVar = []
		var expected = window.name.split(";=;")

		if (expected.length) {

			for (var i = 0; i < expected.length; i++) {

				var item = expected[i]
				var res = _.url.getParam(item)

				if (typeof res === "undefined") {
					undefinedVar.push(item)
				} else {
					result[item] = res
				}
			}
		}

		var data = {
			testId: testId,
			content: result,
			undefinedVar: undefinedVar
		}

		parent.postMessage(JSON.stringify(data), '*')
	}
})();
</script>
</body>
</html>
